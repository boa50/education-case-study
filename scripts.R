# loading libraries
library(tidyverse)
library(janitor)

# set working directory
# putting this way to become easier to manage the variables
setwd("/home/boa50/Desenvolvimento/education-case-study")

# data obtained from https://datacatalog.worldbank.org/search/dataset/0038480 at 04/07/2022
df <- read_csv('dataset/EdStatsData.csv')

# I used a spreadsheet (Libre office calc) to analyze what the indicators represent

# try to sum the columns
df %>%
  filter(`Indicator Code` == 'SE.COM.DURS' & !is.na(`2020`))

filter_2020_df <- df %>%
  filter(!is.na(`2015`))

# getting unique indicators with values on 2020
unique(filter_2020_df$`Indicator Name`)


# there are no values to the Population topic for the recent years
age_indicators <- c('SP.POP.AG00.FE.UN','SP.POP.AG00.MA.UN','SP.POP.AG00.TO.UN','SP.POP.AG01.FE.UN','SP.POP.AG01.MA.UN','SP.POP.AG01.TO.UN','SP.POP.AG02.FE.UN','SP.POP.AG02.MA.UN','SP.POP.AG02.TO.UN','SP.POP.AG03.FE.UN','SP.POP.AG03.MA.UN','SP.POP.AG03.TO.UN','SP.POP.AG04.FE.UN','SP.POP.AG04.MA.UN','SP.POP.AG04.TO.UN','SP.POP.AG05.FE.UN','SP.POP.AG05.MA.UN','SP.POP.AG05.TO.UN','SP.POP.AG06.FE.UN','SP.POP.AG06.MA.UN','SP.POP.AG06.TO.UN','SP.POP.AG07.FE.UN','SP.POP.AG07.MA.UN','SP.POP.AG07.TO.UN','SP.POP.AG08.FE.UN','SP.POP.AG08.MA.UN','SP.POP.AG08.TO.UN','SP.POP.AG09.FE.UN','SP.POP.AG09.MA.UN','SP.POP.AG09.TO.UN','SP.POP.AG10.FE.UN','SP.POP.AG10.MA.UN','SP.POP.AG10.TO.UN','SP.POP.AG11.FE.UN','SP.POP.AG11.MA.UN','SP.POP.AG11.TO.UN','SP.POP.AG12.FE.UN','SP.POP.AG12.MA.UN','SP.POP.AG12.TO.UN','SP.POP.AG13.FE.UN','SP.POP.AG13.MA.UN','SP.POP.AG13.TO.UN','SP.POP.AG14.FE.UN','SP.POP.AG14.MA.UN','SP.POP.AG14.TO.UN','SP.POP.AG15.FE.UN','SP.POP.AG15.MA.UN','SP.POP.AG15.TO.UN','SP.POP.AG16.FE.UN','SP.POP.AG16.MA.UN','SP.POP.AG16.TO.UN','SP.POP.AG17.FE.UN','SP.POP.AG17.MA.UN','SP.POP.AG17.TO.UN','SP.POP.AG18.FE.UN','SP.POP.AG18.MA.UN','SP.POP.AG18.TO.UN','SP.POP.AG19.FE.UN','SP.POP.AG19.MA.UN','SP.POP.AG19.TO.UN','SP.POP.AG20.FE.UN','SP.POP.AG20.MA.UN','SP.POP.AG20.TO.UN','SP.POP.AG21.FE.UN','SP.POP.AG21.MA.UN','SP.POP.AG21.TO.UN','SP.POP.AG22.FE.UN','SP.POP.AG22.MA.UN','SP.POP.AG22.TO.UN','SP.POP.AG23.FE.UN','SP.POP.AG23.MA.UN','SP.POP.AG23.TO.UN','SP.POP.AG24.FE.UN','SP.POP.AG24.MA.UN','SP.POP.AG24.TO.UN','SP.POP.AG25.FE.UN','SP.POP.AG25.MA.UN','SP.POP.AG25.TO.UN')
age_indicators_derived <- c('SP.POP.0305.FE.UN','SP.POP.0305.MA.UN','SP.POP.0305.TO.UN','SP.POP.0406.FE.UN','SP.POP.0406.MA.UN','SP.POP.0406.TO.UN','SP.POP.0509.FE.UN','SP.POP.0509.MA.UN','SP.POP.0509.TO.UN','SP.POP.0510.FE.UN','SP.POP.0510.MA.UN','SP.POP.0510.TO.UN','SP.POP.0511.FE.UN','SP.POP.0511.MA.UN','SP.POP.0511.TO.UN','SP.POP.0609.FE.UN','SP.POP.0609.MA.UN','SP.POP.0609.TO.UN','SP.POP.0610.FE.UN','SP.POP.0610.MA.UN','SP.POP.0610.TO.UN','SP.POP.0611.FE.UN','SP.POP.0611.MA.UN','SP.POP.0611.TO.UN','SP.POP.0612.FE.UN','SP.POP.0612.MA.UN','SP.POP.0612.TO.UN','SP.POP.0709.FE.UN','SP.POP.0709.MA.UN','SP.POP.0709.TO.UN','SP.POP.0710.FE.UN','SP.POP.0710.MA.UN','SP.POP.0710.TO.UN','SP.POP.0711.FE.UN','SP.POP.0711.MA.UN','SP.POP.0711.TO.UN','SP.POP.0712.FE.UN','SP.POP.0712.MA.UN','SP.POP.0712.TO.UN','SP.POP.0713.FE.UN','SP.POP.0713.MA.UN','SP.POP.0713.TO.UN','SP.POP.1014.FE.UN','SP.POP.1014.MA.UN','SP.POP.1014.TO.UN','SP.POP.1015.FE.UN','SP.POP.1015.MA.UN','SP.POP.1015.TO.UN','SP.POP.1016.FE.UN','SP.POP.1016.MA.UN','SP.POP.1016.TO.UN','SP.POP.1017.FE.UN','SP.POP.1017.MA.UN','SP.POP.1017.TO.UN','SP.POP.1018.FE.UN','SP.POP.1018.MA.UN','SP.POP.1018.TO.UN','SP.POP.1115.FE.UN','SP.POP.1115.MA.UN','SP.POP.1115.TO.UN','SP.POP.1116.FE.UN','SP.POP.1116.MA.UN','SP.POP.1116.TO.UN','SP.POP.1117.FE.UN','SP.POP.1117.MA.UN','SP.POP.1117.TO.UN','SP.POP.1118.FE.UN','SP.POP.1118.MA.UN','SP.POP.1118.TO.UN','SP.POP.1215.FE.UN','SP.POP.1215.MA.UN','SP.POP.1215.TO.UN','SP.POP.1216.FE.UN','SP.POP.1216.MA.UN','SP.POP.1216.TO.UN','SP.POP.1217.FE.UN','SP.POP.1217.MA.UN','SP.POP.1217.TO.UN','SP.POP.1218.FE.UN','SP.POP.1218.MA.UN','SP.POP.1218.TO.UN','SP.POP.1316.FE.UN','SP.POP.1316.MA.UN','SP.POP.1316.TO.UN','SP.POP.1317.FE.UN','SP.POP.1317.MA.UN','SP.POP.1317.TO.UN','SP.POP.1318.FE.UN','SP.POP.1318.MA.UN','SP.POP.1318.TO.UN','SP.POP.1319.FE.UN','SP.POP.1319.MA.UN','SP.POP.1319.TO.UN','SP.POP.1418.FE.UN','SP.POP.1418.MA.UN','SP.POP.1418.TO.UN','SP.POP.1419.FE.UN','SP.POP.1419.MA.UN','SP.POP.1419.TO.UN','SP.POP.1524.FE.UN','SP.POP.1524.MA.UN','SP.POP.1524.TO.UN')

df %>%
  filter(`Indicator Code` %in% age_indicators) %>%
  # removing the NA columns
  remove_empty(which = "cols")


filtered_df <- df %>%
  filter(`Indicator Code` == 'NY.GDP.PCAP.KD') %>%
  # removing the NA columns
  remove_empty(which = "cols")
  
rowSums(is.na(filtered_df))
